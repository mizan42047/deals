(window.CTIWidgetClientJsonp=window.CTIWidgetClientJsonp||[]).push([[4],{Rzf1:function(e,t,i){"use strict";function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e){return e&&e.length?~e.indexOf(" ",250)?e.slice(0,e.indexOf(" ",e.length))+"...":e:null}i.r(t),i.d(t,"default",(function(){return c}));var o=i("NMMh"),a={"peaks-container":"_5v1qk4ec","clear-msg":"_5k5sktvt","slide-top":"_2wef1mb7","animation-btn-clear":"_4x6r6wj4","slide-bottom":"_3hksbk4j","left-deviation":"_8jupvvvr","peak-element-content":"_7x5cp5st","peak-clear":"_7arf397u","item-1":"j8wn2kmp","slide-left":"_4rbce62d","item-2":"u3cnj2t4","item-3":"_4nskkz4p","direction-rtl":"_4ak91ehw","slide-right":"_4pmu4s29",image:"_21tqmabc","peak-element":"_45z8c3kh","slide-top-enter":"_7d6xg3wj","slide-top-reposition-1":"_2xewd8ba","slide-top-reposition-2":"_8gbsf9cc","item-leave":"_6djm877e","slide-top-leave":"_3tvvuy2y",file:"_5xa4pzz8","truncate-2-line-text":"_84e6wgfc","clear-1":"_42h71t46","slide-top-btn-clear":"_2ndy36a1","clear-2":"_84nbjtrz","slide-top-btn-clear-2":"hj8c34u5","clear-3":"_4y9q2c61","slide-top-btn-clear-3":"_7kjmyvph"},r=i("nSQ1"),l=i("GXPF");class c extends o.Component{constructor(){super(),s(this,"notifiedMessagesId",{}),s(this,"hideTimer",0),s(this,"clearMessage",(()=>{localStorage.setItem("timeClearMessage",Date.now().toString()),this.setState({isMessageCleared:!0}),this.props.clearedMessages()})),s(this,"onMouseEnterHandler",(()=>{this.setState({isFistHovered:!0,isHover:!0})})),s(this,"onMouseLeaveHandler",(()=>{this.setState({isHover:!1})})),s(this,"callbackHandlerFunction",(e=>{e&&setTimeout((()=>{this.setState({greeting:!1,stack:[]})}),600)})),this.state={stack:[],isFistHovered:!1,isHover:!1,isMessageCleared:!1,hide:!1}}componentWillReceiveProps(e){const{frameData:t,frameNotify:i,opt:{}}=e,s={isMessageCleared:!1};if(t&&i){const{notificationConfig:e}=t,{messages:n}=i;if(n&&n.length){const{stack:t}=this.state,i=[...t,...n.filter((e=>!this.notifiedMessagesId[e.id])).reverse()];n.forEach((e=>this.notifiedMessagesId[e.id]=!0));const o=e.popupAmount,a=localStorage.getItem("timeClearMessage");s.stack=i.slice(-o).filter((e=>!e.timestamp||!a||e.timestamp>+a)),(s.greeting||e.popupAmount&&s.stack.length>0)&&(s.isHover=!0),s.greeting=!1}else s.stack=[],this.notifiedMessagesId={}}this.setState(s)}popupHide(){if(this.hideTimer)return;const{popupAutoCloseTime:e,popupAutoClose:t}=this.props.frameData.notificationConfig;e&&t&&(this.hideTimer=window.setTimeout((()=>{this.setState({hide:!0})}),1e3*e))}clearTimer(){this.hideTimer&&window.clearTimeout(this.hideTimer)}componentWillUnmount(){this.clearTimer()}render(){const{frameData:e}=this.props;if(!e)return null;const{notificationConfig:t,position:i,language:s={}}=e;let n;(this.state.greeting||t.popupAmount&&this.state.stack.length>0)&&(n=!0);const c=!this.state.isHover&&this.state.isFistHovered?"animation-btn-clear":"",p=`clear-${this.state.stack.length}`;if(!n)return null;this.popupHide();const m=this.getCustomStyle(e),u=(this.state.stack||[]).filter((e=>!!(e.image||e.audio||e.video||e.file||e.cards||e.text||e.list))),d=u.map(((e,i,s)=>{let{length:n}=s;return Object(o.h)(h,{key:e.id,index:i,handleClickParent:this.callbackHandlerFunction,notificationConfig:t,isClear:this.state.isMessageCleared,total:n,message:e,onClick:this.props.onClick})})),g=this.state.isMessageCleared||this.state.hide?null:Object(o.h)("div",{className:a["clear-msg"]+" "+a[c]+" "+a[p],onClick:this.clearMessage},Object(o.h)(r.a,null)),f=[a["peaks-container"],a[s&&s.textDirection===l.a.RTL?"direction-rtl":""],a["left"===i.alignment?"left-deviation":""]].filter(Boolean).join(" ");return u.length?Object(o.h)("div",{className:f,style:m},g,d):null}getCustomStyle(e){let t={};return t=e.position&&e.position.enabledCustomMargin?this.getStyleCustomPosition(t,e.position,e.launcher):this.getStylePositionDefault(t,e.launcher),t}getStyleCustomPosition(e,t,i){return t&&(e.marginLeft=t.margin,e.marginRight=t.margin,e.marginBottom=t.marginBottom,i&&(e.marginBottom+=this.getLauncherHeight(i)+8)),e}getStylePositionDefault(e,t){return e.marginLeft=8,e.marginRight=8,e.marginBottom=16,t&&(e.marginBottom+=this.getLauncherHeight(t)+8),e}getLauncherHeight(e){return e&&"icon"===e.type?60:44}}class h extends o.Component{constructor(e){super(e),s(this,"showTimer",0),s(this,"hideTimer",0);const{popupShow:t}=e.notificationConfig;this.state={hide:!!t}}popupHide(){if(this.hideTimer)return;const{popupAutoCloseTime:e,popupAutoClose:t}=this.props.notificationConfig;e&&t&&(this.hideTimer=window.setTimeout((()=>{this.setState({hide:!0})}),1e3*e))}clearTimer(){this.showTimer&&window.clearTimeout(this.showTimer),this.hideTimer&&window.clearTimeout(this.hideTimer)}onClick(){this.props.onClick(),this.clearTimer()}componentDidMount(){const{popupShow:e}=this.props.notificationConfig;e?this.showTimer=window.setTimeout((()=>{this.setState({hide:!1}),this.popupHide()}),1e3*e):this.popupHide()}componentWillUnmount(){this.clearTimer()}render(){const{hide:e}=this.state;if(e)return null;const{index:t,total:i,isClear:s,notificationConfig:l,message:c}=this.props,{popupAmount:h}=l;this.props.handleClickParent(s);let m=i-t;m>h&&(m="leave");const u=s?"peak-clear":"peak-element";let d=Object(o.h)("span",null," ");d=c.text?Object(o.h)("span",{className:a["truncate-2-line-text"]},n(c.text)):c.image?Object(o.h)("img",{src:c.image,className:a.image}):c.video?Object(o.h)("span",{className:a.file},r.h," ",p(c.title)):c.file?Object(o.h)("span",{className:a.file},r.g," ",p(c.title)):c.audio?Object(o.h)("span",{className:a.file},r.f," ",p(c.title)):c.list?Object(o.h)("span",{className:a["truncate-2-line-text"]},n(c.list[0].title)):c.cards?Object(o.h)("span",{className:a["truncate-2-line-text"]},n(c.cards[0].title)):Object(o.h)("span",null,"Unsupported message");const g=[a["item-"+m],a[u]].filter(Boolean).join(" ");return Object(o.h)("div",{className:g,onClick:this.props.onClick},Object(o.h)("div",{className:a["peak-element-content"]},d))}}const p=e=>e?e.length>20?e.substr(0,9)+"..."+e.substr(-8):e:"Attachment"}}]);